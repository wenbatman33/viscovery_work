function genericOnClick(e,o){var t;if("video"===e.mediaType){if(e.pageUrl.match("^https?://(?:www.)?youtube.com/watch?"))return void pinstream.OnSaveYoutubeInfo(e.pageUrl,!0);t=e.srcUrl,console.log("srcUrl: "+t)}else if(e.linkUrl){if(e.linkUrl.match("^https?://(?:www.)?youtube.com/watch?"))return void pinstream.OnSaveYoutubeInfo(e.linkUrl,!0);console.log("linkUrl: "+e.linkUrl),t=e.linkUrl}else e.selectionText?(console.log("selectionText: "+e.selectionText),t=e.selectionText):e.frameUrl&&(console.log("frameUrl: "+e.frameUrl),t=e.frameUrl);if(t){var n=document.createElement("a");if(n.href=t,n.host.indexOf("facebook")!=-1)pinstream.OnSaveFbInfo(n.href,null,!0);else if(n.host.indexOf("youtu")!=-1){var i=pinstream.RegexYoutubeWithViemo(n);if(i&&i.length>6){var n=pinstream.GetYoutuBeUrlById(i[6]);pinstream.OnSaveYoutubeInfo(n,!0)}}else pinstream.SaveStorage({webSite:"else",id:"",videoUrl:t,title:""})}}chrome.tabs.onUpdated.addListener(function(e,o,t){o.url&&(o.url.indexOf("out=1")!==-1?(localStorage.clear(),chrome.storage.local.remove("info",function(){console.info("remove info")})):o.url.indexOf("LoadingPage")!==-1?chrome.tabs.sendMessage(e,"Loading"):o.url.indexOf("VideoPage")!==-1&&chrome.tabs.sendMessage(e,"VideoPage"))}),chrome.notifications.onButtonClicked.addListener(function(){chrome.notifications.clear("xxxx",function(){}),chrome.tabs.create({url:pinstream.ManagementUrl(),selected:!0})}),chrome.runtime.onMessage.addListener(function(e,o,t){if(e&&void 0!==e.action)if(0===e.action){var n=e.info;chrome.storage.local.set({info:n},function(){console.info("success")}),chrome.tabs.query({},function(e){e.forEach(function(e){var o=e.url;!o||o.indexOf("/u/success")===-1&&o.indexOf("/LoadingPage")===-1||chrome.tabs.remove(e.id,function(){console.info("remove")})})})}else 1==e.action&&(localStorage.clear(),chrome.storage.local.remove("info",function(){console.info("remove info")}));else pinstream.OnNotifications(e)}),chrome.webRequest.onResponseStarted.addListener(function(e){"post"==e.method.toLowerCase()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){e&&e.length&&(lastTabId=e[0].id,chrome.tabs.sendMessage(lastTabId,"postevent"))})},{urls:["*://www.facebook.com/*"]}),chrome.webRequest.onCompleted.addListener(function(e){"post"!=e.method.toLowerCase()&&"get"!=e.method.toLowerCase()||chrome.tabs.query({active:!0,currentWindow:!0},function(e){e&&e.length&&(lastTabId=e[0].id,chrome.tabs.sendMessage(lastTabId,"event"))})},{urls:["*://api.dailymotion.com/*"]});for(var contexts=["page","selection","link","video","audio"],i=0;i<contexts.length;i++){var context=contexts[i],title="add video",id=chrome.contextMenus.create({title:title,contexts:[context],onclick:genericOnClick});console.log("'"+context+"' item:"+id)}